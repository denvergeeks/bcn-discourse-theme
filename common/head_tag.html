<!-- OneTrust Cookies Consent Notice start for breastcancernow.org -->
<script type="text/javascript" src="https://cdn-ukwest.onetrust.com/consent/eadcfc54-44a8-4b96-8e92-63f1ffe58243/OtAutoBlock.js"></script>
<script src="https://cdn-ukwest.onetrust.com/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="eadcfc54-44a8-4b96-8e92-63f1ffe58243"></script>


<script type="text/javascript">
  function OptanonWrapper() { }
</script>

<script type="text/discourse-plugin" version="0.8">
    api.onPageChange(() =>{

      reloadOTBanner()
      clearDup()
   
    });
    // for testing onPageChange() 
    function randBackground() {
        $('body').css('background-color', '#'+(Math.random()*0xFFFFFF<<0).toString(16));
    }

    function getCookie(name) {
        var value = "; " + document.cookie;
        var parts = value.split("; " + name + "=");
        if (parts.length == 2) {
            return true;
        }
    }

    function reloadOTBanner() {

        var otConsentSdk = document.getElementById("onetrust-consent-sdk");
        if (otConsentSdk) {
            otConsentSdk.remove();
        }

        if (window.OneTrust != null) {
            OneTrust.Init();

            setTimeout(function() {
                OneTrust.LoadBanner();

                var toggleDisplay = document.getElementsByClassName(
                    "ot-sdk-show-settings"
                );

                for (var i = 0; i < toggleDisplay.length; i++) {
                    toggleDisplay[i].onclick = function(event) {
                        event.stopImmediatePropagation();
                        window.OneTrust.ToggleInfoDisplay();
                    };
                }
            }, 1000); 
        }
    }

    //SHOULD BE USED ONLY ON COOKIE POLICY. TRIGGER FUNCTION BELOW TO REMOVE DUPLICATE CATEGORIES
    function clearDup() {
        var sec = document.getElementById("ot-sdk-cookie-policy")
        var tally = [];
        if(sec){
          for (var i = sec.length - 1; i >= 0; i--) {
            if (tally[sec[i].firstChild.innerText] === undefined) {
                tally[sec[i].firstChild.innerText] = 1;
            } else {
                //console.log(i,sec[i].firstChild.innerText);
                sec[i].remove();
                //return true;
            }
          }
        }
     
        //return false;
    }
</script>
<!-- OneTrust Cookies Consent Notice end for breastcancernow.org -->



<!-- HOOKS CONNECTORS --- HOOKS CONNECTORS --- HOOKS CONNECTORS --- HOOKS CONNECTORS --- HOOKS CONNECTORS ---  -->
<!-- HOOKS CONNECTORS --- HOOKS CONNECTORS --- HOOKS CONNECTORS --- HOOKS CONNECTORS --- HOOKS CONNECTORS ---  -->


<script type="text/x-handlebars" data-template-name="/connectors/above-site-header/bcn-hero">
  <div class="bcn-topbar">
    <div class="bcn-topbar__items wrap ">
      <a class="bcn-topbar__item" href="https://breastcancernow.org/">Breast Cancer Now</a>

    </div>
  </div>
</script>


<!-- Dynamic hero banner for NOT home page  -->
<script type="text/discourse-plugin" version="0.8">
  api.registerConnectorClass("below-site-header", "hero", {
      setupComponent(args, component) {
      api.onPageChange((url) => {
          if (url !== "/") {
  
            component.set("displayHero", true);
          } else{
            component.set("displayHero", false);
        }});
      }
  });
</script>

<script type="text/x-handlebars" data-template-name="/connectors/below-site-header/hero">
  {{#if displayHero}}
    <div class="bcn-hero-with-icon-wrapper">
      <div class="bcn-hero-with-icon">
        <div class="bcn-hero-with-icon__inner">
          <div class="bcn-hero-with-icon__content">
            {{mount-widget widget="hero-title"}}
          </div>
          <div class="bcn-hero-with-icon__image"></div>
        </div>
      </div>
    </div>
  {{/if}}
</script>


<!-- Custom hero banner for home page  -->
<script type="text/discourse-plugin" version="0.8">
  api.registerConnectorClass("below-site-header", "hero--homepage", {
  setupComponent(args, component) {
    api.onPageChange((url) => {
      if (url === "/") {
        component.set("displayHeroHomepage", true);
      } else {
        component.set("displayHeroHomepage", false);

      }
    });
  }
});
</script>


<script type="text/x-handlebars" data-template-name="/connectors/below-site-header/hero--homepage">
    {{#if displayHeroHomepage}}

    <div class="bcn-hero-with-icon-wrapper bcn-hero-with-icon-wrapper--homepage">
      <div class="bcn-hero-with-icon bcn-hero-with-icon--homepage">
      <div class="bcn-hero-with-icon__inner">
        <div class="bcn-hero-with-icon__content">
         <h1>Breast Cancer Now forum</h1>
         <h2>With you every step of the way</h2>
       </div>
        <div class="bcn-hero-with-icon__image">
        </div>
      </div>
    </div>
    </div>
     
    {{/if}}
</script>


<script type="text/discourse-plugin" version="0.8">
  api.registerConnectorClass("below-site-header", "homepagecontent", {
    setupComponent(args, component) {
     api.onPageChange((url) => {
        if (url === "/" ){
            document.querySelector("html").classList.add("bcn-homepage");
        } else {
          document.querySelector("html").classList.remove("bcn-homepage");
        }
      });
    }
  });
</script>


<!-- WIDGETS --- WIDGETS --- WIDGETS --- WIDGETS --- WIDGETS --- WIDGETS --- WIDGETS --- WIDGETS ---  -->

<!-- Dynamic Hero Ttile --- Dynamic Hero Ttile --- Dynamic Hero Ttile --- Dynamic Hero Ttile ---  -->

<script type="text/discourse-plugin" version="0.8">

  const h = require("virtual-dom").h;
    const container = Discourse.__container__;

    api.createWidget("hero-title", {

      tagName: "div.bcn-hero-with-icon__content-heading",

      html() {
        const controllerCategory = container.lookup('controller:navigation/category');
        const nameCategory = controllerCategory.get("category.name");
        const categorySubtitle = controllerCategory.get("category.description");

        let heroTitle = ""
        let heroSubtitle = ""
        if(nameCategory){
          heroTitle = nameCategory
          heroSubtitle = categorySubtitle
        } else {
          heroTitle = "Breast Cancer Now forum"
          heroSubtitle = "With you every step of the way"
        }


        api.onPageChange((url, title) => {
          this.scheduleRerender();
        });

        return h(
          'h1',  
          { innerHTML : heroTitle },
          h('h2', {innerHTML : heroSubtitle})
          
        )
      }

    });
</script>

<!-- Dynamic Hero SubTitle --- Dynamic Hero SubTitle --- Dynamic Hero SubTitle ---  -->

<script type="text/discourse-plugin" version="0.8">

  const h = require("virtual-dom").h;
    const container = Discourse.__container__;
    api.createWidget("hero-subtitle", {
      tagName: "div.bcn-hero-with-icon__content-subtitle",

      html() {
        const controllerCategory = container.lookup('controller:navigation/category');
        const controllerTopic = container.lookup('controller:topic');
        const categorySubtitle = controllerCategory.get("category.description");

        let heroSubtitle = ""

        api.onPageChange((url) => {
          
          if (url === "/"){
            heroSubtitle = "With you every step of the way"
          }
            this.scheduleRerender();
          });

        if(categorySubtitle){
          heroSubtitle = categorySubtitle
        } 
  
        return h(
           'h4',  { innerHTML : heroSubtitle }

        )
      }

    });
</script>